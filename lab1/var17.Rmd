---
title: "Лабораторная работа 1, вариант 17"
output: html_notebook
---

1. Задать объем выборки $N$.

```{r}
  N = 10000
```



2. Задать параметры

```{r}
  p1 = 0.1
  p2 = 0.2
  p3 = 0.7
  
  mu = 0 
  sigma_2 = 16
  
  d = 3
  
  a = 0
  b = 5
```

3 Найти аналитически для своего варианта функцию распределения F моделируемого
закона и плотность распределения. Вычислить математическое ожидание и дисперсию
этого распределения.

3.1 Функция распределения смеси Нормального, Арксинуса и равномерного:

$F(x) = 0.1 *[1 + erf(\frac{x}{4\sqrt{2}})] + 0.2 * [0.5 + \frac{1}{\pi} * \arcsin(\frac{x}{3})] + 0.7 * [\frac{x}{5}], x \in (0,3)$

3.2 Плотность распределения смеси Нормального, Арксинуса и равномерного:

$f(x) = 0.1* [\frac{1}{4\sqrt{2\pi}}*e^{-\frac{x^2}{32}}] + 0.2*[\frac{1}{\pi}*\frac{1}{\sqrt{(9-x^2)}}] + 0.7 * [\frac{1}{5}]$

3.3 Математическое ожидание смеси:

$E = 0.1*E_1 + 0.2*E_2 + 0.7*E_3 = 0.1*[0] + 0.2*[\frac{1}{2}] + 0.7*[\frac{0+5}{2}] = \frac{37}{20} = 1.85$

3.4 Дисперсия смеси:

$D[X] = E[X^2]-E^2[X] = \frac{509}{24} - \frac{31}{12}  = \frac{447}{24} = 18.625$ , где 

$E_1[X^2] = D_1[x] + E_1^2[X] = \sigma^2 + \mu^2 = 16, E_2[X^2] = D_2[x] + E_2^2[X] = \frac{1}{8} + \frac{1}{2} = \frac{5}{8}, E_3[X^2] = D_3[x] + E_3^2[X] = \frac{5}{2} + \frac{25}{12} = \frac{55}{12}$


$E_1[X^2] + E_2[X^2] + E_3[X^2] = E[X^2] = 16 + \frac{5}{8} + \frac{55}{12} = \frac{509}{24}$

$E_1^2[X] = 0, E_2^2[X] = \frac{1}{2}, E_3^2[X] = \frac{25}{12}$

$E_1^2[X] + E_2^2[X] + E_3^2[X] = E^2[X] = 0 + \frac{1}{2} + \frac{25}{12} = \frac{31}{12}$


4. Смоделировать с помощью генераторов случайных чисел выборку из заданного
(согласно своему варианту) распределения.

```{r}
F2_rev <- function(y) {
   return(3*sin(1/2 * pi*(2*y-1)))
}
```


```{r}
  U1 = rnorm(N, mu, sigma_2) # norm distribution
  U2 = F2_rev(runif(N, 0, 1))# arcsin distribution, Smirnov method
  U3 = runif(N, a, b)        # uniform distribution
```

```{r}
  random_vector = sample(0:2, N, TRUE)
  mixed = U1*(random_vector==0) + U2*(random_vector == 1) + U3*(random_vector == 2)
```

5. Построить в одном графическом окне графики функции распределения F и
эмпирической функции распределения Fn, сравнить их визуально.

```{r}
F <- function(x) { 
  
  # distribution mix 
  return ( 0.1 * pnorm(x, mean=mu, sd = sigma_2) + 0.2 * (0.5 + 1/pi * asin(x/3)) + 0.7*x/5)
}
```



```{r}
  x = seq(0, 3, 0.01)
  plot(x, F(x) , type="l", col="Deep Sky Blue", lwd=5)
  lines(ecdf(mixed), col="Dark red", lwd=2)
```

6. Построить в одном графическом окне график плотности распределения и
гистограмму относительных частот, задав количество интервалов по формуле $m = round (1.72 · n^\frac{1}{3})$

```{r}

```



7. Вычислить значения оценок математического ожидания и дисперсии по полученной
в п. 4 выборке. Сравнить статистические оценки математического ожидания и дисперсии
с их теоретическими значениями.
